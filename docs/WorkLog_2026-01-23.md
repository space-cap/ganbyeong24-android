# ê°„ë³‘24 ê°œë°œ ì¼ì§€ - 2026-01-23 (Day 10)

> ğŸ“… **ì‘ì—…ì¼**: 2026-01-23  
> ğŸ‘¨â€ğŸ’» **ê°œë°œì**: space-cap  
> ğŸ¯ **ëª©í‘œ**: ê´€ë¦¬ì ì‹œìŠ¤í…œ ì „ì²´ êµ¬ì¶• ë° SerialNumber ì‹œìŠ¤í…œ êµ¬í˜„

---

## ğŸ“‹ ì‘ì—… ìš”ì•½

ì˜¤ëŠ˜ì€ **ê´€ë¦¬ì ì‹œìŠ¤í…œ ì „ì²´**ì™€ **SerialNumber ì‹œìŠ¤í…œ**ì„ ì™„ì„±í–ˆìŠµë‹ˆë‹¤. ì´ë¡œì¨ ê°„ë³‘24 ì•±ì˜ í•µì‹¬ ê¸°ëŠ¥ì¸ ê°„ë³‘ ì‹ ì²­, ê°„ë³‘ì‚¬ ë“±ë¡, ë§¤ì¹­ ê´€ë¦¬ê°€ ëª¨ë‘ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## âœ… ì™„ë£Œí•œ ì‘ì—…

### Aë‹¨ê³„: ê´€ë¦¬ì ì¸ì¦ ì‹œìŠ¤í…œ

#### êµ¬í˜„ ë‚´ìš©
- **User ëª¨ë¸ í™•ì¥**: `role` í•„ë“œ ì¶”ê°€ (`"guardian"`, `"caregiver"`, `"admin"`)
- **ê´€ë¦¬ì ê¶Œí•œ í™•ì¸**: `AuthRepository`ì— `isAdmin()` í•¨ìˆ˜ ì¶”ê°€
- **AdminDashboard í™”ë©´**: ê´€ë¦¬ì ì „ìš© ëŒ€ì‹œë³´ë“œ ìƒì„±

#### ì£¼ìš” íŒŒì¼
- [User.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/data/model/User.kt)
- [AuthRepository.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/data/repository/AuthRepository.kt)
- [AdminDashboardScreen.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/presentation/screens/admin/AdminDashboardScreen.kt)

#### ì„¤ê³„ ê²°ì •
- **ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (RBAC)**: ì‚¬ìš©ì ì—­í• ì— ë”°ë¼ í™”ë©´ ì ‘ê·¼ ì œí•œ
- **Firestore ê¸°ë°˜ ì—­í•  ê´€ë¦¬**: `users` ì»¬ë ‰ì…˜ì˜ `role` í•„ë“œë¡œ ê´€ë¦¬
- **ê´€ë¦¬ì ê³„ì • ìƒì„±**: Firebase Consoleì—ì„œ ìˆ˜ë™ ìƒì„± í›„ Firestoreì—ì„œ `role: "admin"` ì„¤ì •

---

### Bë‹¨ê³„: ê°„ë³‘ ì‹ ì²­ ëª©ë¡ í™”ë©´ (ê´€ë¦¬ì)

#### êµ¬í˜„ ë‚´ìš©
- **ì „ì²´ ê°„ë³‘ ì‹ ì²­ ì¡°íšŒ**: Firestoreì—ì„œ ëª¨ë“  ê°„ë³‘ ì‹ ì²­ ë°ì´í„° ì¡°íšŒ
- **ìƒíƒœë³„ í•„í„°ë§**: ì „ì²´/ëŒ€ê¸°/ë§¤ì¹­/ì™„ë£Œ/ì·¨ì†Œ í•„í„° ì œê³µ
- **Material Design 3 UI**: ì¹´ë“œ í˜•íƒœì˜ ëª©ë¡, ìƒíƒœ ë°°ì§€, í•„í„° ì¹©

#### ì£¼ìš” íŒŒì¼
- [AdminCareRequestListViewModel.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/presentation/screens/admin/care_request/AdminCareRequestListViewModel.kt)
- [AdminCareRequestListScreen.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/presentation/screens/admin/care_request/AdminCareRequestListScreen.kt)

#### ê¸°ëŠ¥ ìƒì„¸
1. **í•„í„°ë§ ì‹œìŠ¤í…œ**:
   - ì „ì²´: ëª¨ë“  ì‹ ì²­ í‘œì‹œ
   - ëŒ€ê¸°: `status == "pending"`
   - ë§¤ì¹­: `status == "matched"`
   - ì™„ë£Œ: `status == "completed"`
   - ì·¨ì†Œ: `status == "cancelled"`

2. **UI êµ¬ì„±**:
   - TopAppBar: ì œëª© + ë’¤ë¡œê°€ê¸°
   - FilterChip Row: ìƒíƒœë³„ í•„í„°
   - LazyColumn: ì‹ ì²­ ëª©ë¡ (ì¹´ë“œ í˜•íƒœ)
   - ê° ì¹´ë“œ: í™˜ì ì •ë³´, ì§€ì—­, ê¸°ê°„, ìƒíƒœ ë°°ì§€

---

### Cë‹¨ê³„: ê°„ë³‘ì‚¬ ëª©ë¡ í™”ë©´ (ê´€ë¦¬ì)

#### êµ¬í˜„ ë‚´ìš©
- **ì „ì²´ ê°„ë³‘ì‚¬ ì¡°íšŒ**: Firestoreì—ì„œ ëª¨ë“  ê°„ë³‘ì‚¬ ë°ì´í„° ì¡°íšŒ
- **ë‹¤ì¤‘ í•„í„°ë§**: ì§€ì—­ AND ìê²©ì¦ AND ê²½ë ¥ ì¡°ê±´ ë™ì‹œ ì ìš©
- **í”„ë¡œí•„ ì‚¬ì§„ í‘œì‹œ**: Base64 ë””ì½”ë”©í•˜ì—¬ ì´ë¯¸ì§€ í‘œì‹œ

#### ì£¼ìš” íŒŒì¼
- [AdminCaregiverListViewModel.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/presentation/screens/admin/caregiver/AdminCaregiverListViewModel.kt)
- [AdminCaregiverListScreen.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/presentation/screens/admin/caregiver/AdminCaregiverListScreen.kt)

#### í•„í„°ë§ ë¡œì§
```kotlin
// ì§€ì—­ í•„í„° (OR ì¡°ê±´)
val regionMatch = selectedRegions.isEmpty() || 
    caregiver.availableRegions.any { it in selectedRegions }

// ìê²©ì¦ í•„í„° (OR ì¡°ê±´)
val certificateMatch = selectedCertificates.isEmpty() || 
    caregiver.certificates.any { it in selectedCertificates }

// ê²½ë ¥ í•„í„° (ë‹¨ì¼ ì„ íƒ)
val experienceMatch = selectedExperience.isEmpty() || 
    caregiver.experience == selectedExperience

// ìµœì¢… í•„í„° (AND ì¡°ê±´)
regionMatch && certificateMatch && experienceMatch
```

---

### Dë‹¨ê³„: SerialNumber ì‹œìŠ¤í…œ êµ¬í˜„ â­

#### ì„¤ê³„ ë°°ê²½
**ë¬¸ì œ**: Firestore ë¬¸ì„œ IDëŠ” ì‚¬ëŒì´ ì½ê¸° ì–´ë ¤ì›€ (ì˜ˆ: `xK9mP2qL7nR4sT8v`)  
**í•´ê²°**: ì‚¬ëŒì´ ì½ê¸° ì‰¬ìš´ ì¼ë ¨ë²ˆí˜¸ ì‹œìŠ¤í…œ ë„ì…

#### ë²ˆí˜¸ ì²´ê³„
| êµ¬ë¶„ | ì‹œì‘ ë²ˆí˜¸ | í¬ë§· | í™”ë©´ í‘œì‹œ ì˜ˆì‹œ |
|------|-----------|------|----------------|
| ê°„ë³‘ ì‹ ì²­ | 10000000001 | `100-0000-0001` | ê°„ë³‘ ì‹ ì²­ #100-0000-0001 |
| ê°„ë³‘ì‚¬ | 20000000001 | `200-0000-0001` | ê°„ë³‘ì‚¬ #200-0000-0001 |
| ë§¤ì¹­ | 30000000001 | `300-0000-0001` | ë§¤ì¹­ #300-0000-0001 |

#### êµ¬í˜„ ìƒì„¸

##### 1. ë°ì´í„° ëª¨ë¸ ìˆ˜ì •
```kotlin
data class CareRequest(
    @get:Exclude val id: String = "",
    val serialNumber: Long = 0,  // 10000000001~
    val userId: String = "",
    // ... ê¸°íƒ€ í•„ë“œ
)

data class Caregiver(
    @get:Exclude val id: String = "",
    val serialNumber: Long = 0,  // 20000000001~
    val userId: String = "",
    // ... ê¸°íƒ€ í•„ë“œ
)

data class Match(
    @get:Exclude val id: String = "",
    val serialNumber: Long = 0,  // 30000000001~
    // ... ê¸°íƒ€ í•„ë“œ
)
```

##### 2. Firestore Counter êµ¬ì¡°
```
counters/
â”œâ”€â”€ care_request_counter
â”‚   â””â”€â”€ value: 10000000003
â”œâ”€â”€ caregiver_counter
â”‚   â””â”€â”€ value: 20000000005
â””â”€â”€ match_counter
    â””â”€â”€ value: 30000000002
```

##### 3. ì¼ë ¨ë²ˆí˜¸ ìƒì„± (Transaction)
```kotlin
override suspend fun generateSerialNumber(): Result<Long> {
    return try {
        val counterRef = firestore.collection("counters")
            .document("care_request_counter")
        
        val newNumber = firestore.runTransaction { transaction ->
            val snapshot = transaction.get(counterRef)
            
            if (!snapshot.exists()) {
                // ì²« ë²ˆì§¸ ë²ˆí˜¸ ìƒì„±
                transaction.set(counterRef, mapOf("value" to 10000000000L))
                10000000001L
            } else {
                // ê¸°ì¡´ ë²ˆí˜¸ ì¦ê°€
                val currentValue = snapshot.getLong("value") ?: 10000000000L
                val newValue = currentValue + 1
                transaction.update(counterRef, "value", newValue)
                newValue
            }
        }.await()
        
        Result.success(newNumber)
    } catch (e: Exception) {
        Result.failure(e)
    }
}
```

##### 4. í¬ë§·íŒ… ìœ í‹¸ë¦¬í‹°
```kotlin
object SerialNumberFormatter {
    /**
     * 11ìë¦¬ ìˆ«ìë¥¼ 3-4-4 í˜•ì‹ìœ¼ë¡œ í¬ë§·íŒ…
     * ì˜ˆ: 10000000001 â†’ "100-0000-0001"
     */
    fun format(serialNumber: Long): String {
        val str = serialNumber.toString()
        return "${str.substring(0, 3)}-${str.substring(3, 7)}-${str.substring(7)}"
    }
    
    fun formatCareRequest(serialNumber: Long) = "ê°„ë³‘ ì‹ ì²­ #${format(serialNumber)}"
    fun formatCaregiver(serialNumber: Long) = "ê°„ë³‘ì‚¬ #${format(serialNumber)}"
    fun formatMatch(serialNumber: Long) = "ë§¤ì¹­ #${format(serialNumber)}"
}
```

#### ì¥ì 
- âœ… **ê°€ë…ì„±**: ì‚¬ëŒì´ ì½ê³  ë§í•˜ê¸° ì‰¬ì›€
- âœ… **ê²€ìƒ‰ì„±**: Firebase Consoleì—ì„œ ë²ˆí˜¸ë¡œ ê²€ìƒ‰ ê°€ëŠ¥
- âœ… **ê³ ê° ì§€ì›**: ì „í™” ìƒë‹´ ì‹œ ì°¸ì¡° ë²ˆí˜¸ë¡œ ì‚¬ìš©
- âœ… **ì¤‘ë³µ ë°©ì§€**: Firestore Transactionìœ¼ë¡œ ì™„ë²½í•œ ì¤‘ë³µ ë°©ì§€
- âœ… **í™•ì¥ì„±**: ê° ì—”í‹°í‹°ë³„ ë…ë¦½ì ì¸ ë²ˆí˜¸ ì²´ê³„

#### ì£¼ìš” íŒŒì¼
- [SerialNumberFormatter.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/util/SerialNumberFormatter.kt)
- [CareRequestRepository.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/data/repository/CareRequestRepository.kt)
- [CaregiverRepository.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/data/repository/CaregiverRepository.kt)

---

### Eë‹¨ê³„: ë§¤ì¹­ ê´€ë¦¬ í™”ë©´ (3ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤)

#### êµ¬í˜„ ë‚´ìš©

##### 1. Match ë°ì´í„° ëª¨ë¸
```kotlin
data class Match(
    @get:Exclude val id: String = "",
    val serialNumber: Long = 0,
    val careRequestSerialNumber: Long = 0,  // ê°„ë³‘ ì‹ ì²­ ë²ˆí˜¸
    val caregiverSerialNumber: Long = 0,    // ê°„ë³‘ì‚¬ ë²ˆí˜¸
    val status: String = "pending",         // pending, active, completed, cancelled
    val notes: String = "",                 // ê´€ë¦¬ì ë©”ëª¨
    val createdAt: Timestamp = Timestamp.now(),
    val updatedAt: Timestamp = Timestamp.now()
)
```

##### 2. MatchRepository
- **CRUD ê¸°ëŠ¥**: ìƒì„±, ì¡°íšŒ, ì—…ë°ì´íŠ¸, ì‚­ì œ
- **ì¼ë ¨ë²ˆí˜¸ ìƒì„±**: 30000000000ë¶€í„° ì‹œì‘
- **Firestore Transaction**: ì¤‘ë³µ ë°©ì§€

##### 3. MatchManagementViewModel
- **3ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬**: Step 1 â†’ Step 2 â†’ Step 3 â†’ Success
- **ì§€ì—­ ê¸°ë°˜ ìë™ í•„í„°ë§**: ì„ íƒëœ ì‹ ì²­ì˜ ì§€ì—­ê³¼ ì¼ì¹˜í•˜ëŠ” ê°„ë³‘ì‚¬ ìš°ì„  í‘œì‹œ
- **ë§¤ì¹­ ìƒì„± ë° ìƒíƒœ ì—…ë°ì´íŠ¸**: Match ìƒì„± + CareRequest ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸

##### 4. MatchManagementScreen (3ë‹¨ê³„ UI)

**Step 1: ê°„ë³‘ ì‹ ì²­ ì„ íƒ**
- `pending` ìƒíƒœ ì‹ ì²­ë§Œ í‘œì‹œ
- í™˜ì ì •ë³´, ì§€ì—­, ê¸°ê°„ í‘œì‹œ
- ì¹´ë“œ ì„ íƒ ì‹œ Step 2ë¡œ ì´ë™

**Step 2: ê°„ë³‘ì‚¬ ì„ íƒ**
- ì „ì²´ ê°„ë³‘ì‚¬ ëª©ë¡ í‘œì‹œ
- ì„ íƒëœ ì‹ ì²­ì˜ ì§€ì—­ê³¼ ì¼ì¹˜í•˜ëŠ” ê°„ë³‘ì‚¬ì— "ì§€ì—­ ì¼ì¹˜" ì¹© í‘œì‹œ
- í”„ë¡œí•„ ì‚¬ì§„, ì´ë¦„, ê²½ë ¥, ìê²©ì¦, ê°€ëŠ¥ ì§€ì—­ í‘œì‹œ
- ì¹´ë“œ ì„ íƒ ì‹œ Step 3ë¡œ ì´ë™

**Step 3: ë§¤ì¹­ í™•ì¸**
- ì„ íƒëœ ì‹ ì²­ ë° ê°„ë³‘ì‚¬ ì •ë³´ ìš”ì•½
- ê´€ë¦¬ì ë©”ëª¨ ì…ë ¥ (ì„ íƒ ì‚¬í•­)
- "ë§¤ì¹­ ìƒì„±" ë²„íŠ¼

**Success í™”ë©´**
- ë§¤ì¹­ ë²ˆí˜¸ í‘œì‹œ (ì˜ˆ: `ë§¤ì¹­ #300-0000-0001`)
- ì„±ê³µ ë©”ì‹œì§€
- 2ì´ˆ í›„ ìë™ìœ¼ë¡œ ë’¤ë¡œê°€ê¸°

##### ìë™ ì²˜ë¦¬ ë¡œì§
```kotlin
suspend fun createMatch(notes: String) {
    // 1. ë§¤ì¹­ ì¼ë ¨ë²ˆí˜¸ ìƒì„±
    val serialNumber = matchRepository.generateSerialNumber().getOrThrow()
    
    // 2. Match ë¬¸ì„œ ìƒì„±
    val match = Match(
        serialNumber = serialNumber,
        careRequestSerialNumber = selectedCareRequest.serialNumber,
        caregiverSerialNumber = selectedCaregiver.serialNumber,
        status = "pending",
        notes = notes
    )
    matchRepository.createMatch(match)
    
    // 3. CareRequest ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸ (pending â†’ matched)
    careRequestRepository.updateStatus(
        selectedCareRequest.id, 
        "matched"
    )
}
```

#### ì£¼ìš” íŒŒì¼
- [Match.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/data/model/Match.kt)
- [MatchRepository.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/data/repository/MatchRepository.kt)
- [MatchManagementViewModel.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/presentation/screens/admin/match/MatchManagementViewModel.kt)
- [MatchManagementScreen.kt](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/app/src/main/java/com/ezlevup/ganbyeong24/presentation/screens/admin/match/MatchManagementScreen.kt)

---

## ğŸ“š ë¬¸ì„œ ì—…ë°ì´íŠ¸

### ë°ì´í„° ëª¨ë¸ ë¬¸ì„œ
- âœ… [CareRequest.md](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/docs/data-models/CareRequest.md) - `serialNumber` í•„ë“œ ì¶”ê°€
- âœ… [Caregiver.md](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/docs/data-models/Caregiver.md) - `serialNumber` í•„ë“œ ì¶”ê°€
- âœ… [Match.md](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/docs/data-models/Match.md) - ìƒˆë¡œ ìƒì„±
- âœ… [User.md](file:///c:/workdir/space-cap/AndroidStudioProjects/Ganbyeong24/docs/data-models/User.md) - `role` í•„ë“œ ì¶”ê°€

---

## ğŸ¯ í…ŒìŠ¤íŠ¸ ê²°ê³¼

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
1. âœ… **ê´€ë¦¬ì ë¡œê·¸ì¸**: Firebase Consoleì—ì„œ `role: "admin"` ì„¤ì • í›„ ë¡œê·¸ì¸
2. âœ… **ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì ‘ê·¼**: ê¶Œí•œ í™•ì¸ í›„ ëŒ€ì‹œë³´ë“œ í‘œì‹œ
3. âœ… **ê°„ë³‘ ì‹ ì²­ ëª©ë¡ ì¡°íšŒ**: ì „ì²´ ì‹ ì²­ ì¡°íšŒ ë° ìƒíƒœë³„ í•„í„°ë§
4. âœ… **ê°„ë³‘ì‚¬ ëª©ë¡ ì¡°íšŒ**: ì „ì²´ ê°„ë³‘ì‚¬ ì¡°íšŒ ë° ë‹¤ì¤‘ í•„í„°ë§
5. âœ… **ë§¤ì¹­ ê´€ë¦¬ í™”ë©´ ì ‘ê·¼**: 3ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤ ì •ìƒ ì‘ë™
6. âœ… **ë§¤ì¹­ ìƒì„±**: Step 1 â†’ Step 2 â†’ Step 3 â†’ Success
7. âœ… **ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸**: CareRequest ìƒíƒœê°€ `pending` â†’ `matched`ë¡œ ë³€ê²½
8. âœ… **Firebase Console í™•ì¸**: SerialNumber, Match ë¬¸ì„œ, Counter ì •ìƒ ì‘ë™

### í™•ì¸ ì‚¬í•­
- âœ… **SerialNumber ì¤‘ë³µ ì—†ì´ ìƒì„±**: Transactionìœ¼ë¡œ ì™„ë²½í•œ ì¤‘ë³µ ë°©ì§€
- âœ… **Firestore Counter ì •ìƒ ì‘ë™**: ê° ì—”í‹°í‹°ë³„ ë…ë¦½ì ì¸ ì¹´ìš´í„°
- âœ… **ê°„ë³‘ ì‹ ì²­ ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸**: ë§¤ì¹­ ìƒì„± ì‹œ ìë™ ì—…ë°ì´íŠ¸
- âœ… **UI ì •ìƒ í‘œì‹œ**: ëª¨ë“  í™”ë©´ ì •ìƒ ì‘ë™

---

## ğŸ“Š Firestore êµ¬ì¡°

```
firestore/
â”œâ”€â”€ counters/
â”‚   â”œâ”€â”€ care_request_counter
â”‚   â”‚   â””â”€â”€ value: 10000000003
â”‚   â”œâ”€â”€ caregiver_counter
â”‚   â”‚   â””â”€â”€ value: 20000000005
â”‚   â””â”€â”€ match_counter
â”‚       â””â”€â”€ value: 30000000002
â”‚
â”œâ”€â”€ users/
â”‚   â””â”€â”€ {userId}
â”‚       â”œâ”€â”€ email: "admin@ganbyeong24.com"
â”‚       â”œâ”€â”€ role: "admin"  // "guardian", "caregiver", "admin"
â”‚       â”œâ”€â”€ createdAt: Timestamp
â”‚       â””â”€â”€ isDeleted: false
â”‚
â”œâ”€â”€ care_requests/
â”‚   â””â”€â”€ {documentId}
â”‚       â”œâ”€â”€ serialNumber: 10000000001
â”‚       â”œâ”€â”€ userId: "..."
â”‚       â”œâ”€â”€ status: "matched"  // "pending", "matched", "completed", "cancelled"
â”‚       â”œâ”€â”€ patientName: "í™ê¸¸ë™"
â”‚       â”œâ”€â”€ patientAge: 75
â”‚       â”œâ”€â”€ patientGender: "ë‚¨ì„±"
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ caregivers/
â”‚   â””â”€â”€ {documentId}
â”‚       â”œâ”€â”€ serialNumber: 20000000001
â”‚       â”œâ”€â”€ userId: "..."
â”‚       â”œâ”€â”€ name: "ê¹€ê°„ë³‘"
â”‚       â”œâ”€â”€ gender: "ì—¬ì„±"
â”‚       â”œâ”€â”€ experience: "5~10ë…„"
â”‚       â”œâ”€â”€ certificates: ["ìš”ì–‘ë³´í˜¸ì‚¬", "ê°„í˜¸ì¡°ë¬´ì‚¬"]
â”‚       â”œâ”€â”€ availableRegions: ["ì„œìš¸", "ê²½ê¸°"]
â”‚       â””â”€â”€ ...
â”‚
â””â”€â”€ matches/
    â””â”€â”€ {documentId}
        â”œâ”€â”€ serialNumber: 30000000001
        â”œâ”€â”€ careRequestSerialNumber: 10000000001
        â”œâ”€â”€ caregiverSerialNumber: 20000000001
        â”œâ”€â”€ status: "pending"  // "pending", "active", "completed", "cancelled"
        â”œâ”€â”€ notes: "ê´€ë¦¬ì ë©”ëª¨"
        â”œâ”€â”€ createdAt: Timestamp
        â””â”€â”€ updatedAt: Timestamp
```

---

## ğŸ“ ë°°ìš´ ê²ƒ

### 1. Firestore Transaction
- **ì›ìì„± ë³´ì¥**: ì—¬ëŸ¬ ì‘ì—…ì„ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ì–´ ì²˜ë¦¬
- **ì¤‘ë³µ ë°©ì§€**: Counter ì¦ê°€ ì‹œ ë™ì‹œì„± ë¬¸ì œ í•´ê²°
- **ì‚¬ìš©ë²•**:
  ```kotlin
  firestore.runTransaction { transaction ->
      val snapshot = transaction.get(counterRef)
      val newValue = (snapshot.getLong("value") ?: 0L) + 1
      transaction.update(counterRef, "value", newValue)
      newValue
  }.await()
  ```

### 2. ë‹¤ì¤‘ í•„í„°ë§ ë¡œì§
- **AND ì¡°ê±´**: ëª¨ë“  í•„í„°ê°€ ë™ì‹œì— ë§Œì¡±í•´ì•¼ í•¨
- **OR ì¡°ê±´**: ê° í•„í„° ë‚´ì—ì„œëŠ” í•˜ë‚˜ë¼ë„ ì¼ì¹˜í•˜ë©´ ë¨
- **ë¹ˆ í•„í„° ì²˜ë¦¬**: í•„í„°ê°€ ë¹„ì–´ìˆìœ¼ë©´ í•´ë‹¹ ì¡°ê±´ ë¬´ì‹œ

### 3. 3ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤ UI
- **State ê´€ë¦¬**: `currentStep`, `selectedCareRequest`, `selectedCaregiver`
- **ë‹¨ê³„ë³„ UI**: `when (currentStep)` ë¶„ê¸° ì²˜ë¦¬
- **ìë™ ì´ë™**: ì„±ê³µ í›„ `LaunchedEffect` + `delay(2000)` + `navController.popBackStack()`

### 4. ì§€ì—­ ê¸°ë°˜ í•„í„°ë§
- **ìë™ í•„í„°ë§**: ì„ íƒëœ ì‹ ì²­ì˜ ì§€ì—­ê³¼ ì¼ì¹˜í•˜ëŠ” ê°„ë³‘ì‚¬ ìš°ì„  í‘œì‹œ
- **UI í‘œì‹œ**: "ì§€ì—­ ì¼ì¹˜" ì¹©ìœ¼ë¡œ ì‹œê°ì  í‘œì‹œ
- **ì‚¬ìš©ì ê²½í—˜**: ê´€ë¦¬ìê°€ ì í•©í•œ ê°„ë³‘ì‚¬ë¥¼ ë¹ ë¥´ê²Œ ì°¾ì„ ìˆ˜ ìˆìŒ

---

## ğŸ’¡ ì„¤ê³„ ê²°ì •

### 1. SerialNumber vs Firestore ë¬¸ì„œ ID
- **ì„ íƒ**: SerialNumber ì‹œìŠ¤í…œ ë„ì…
- **ì´ìœ **:
  - ì‚¬ëŒì´ ì½ê¸° ì‰¬ì›€ (ì „í™” ìƒë‹´ ì‹œ ì°¸ì¡° ë²ˆí˜¸ë¡œ ì‚¬ìš©)
  - Firebase Consoleì—ì„œ ê²€ìƒ‰ ìš©ì´
  - ê³ ê° ì§€ì› ì‹œ ìœ ìš©
  - ê° ì—”í‹°í‹°ë³„ ë…ë¦½ì ì¸ ë²ˆí˜¸ ì²´ê³„

### 2. Transaction vs Increment
- **ì„ íƒ**: Firestore Transaction ì‚¬ìš©
- **ì´ìœ **:
  - ì™„ë²½í•œ ì¤‘ë³µ ë°©ì§€
  - ë™ì‹œì„± ë¬¸ì œ í•´ê²°
  - ì›ìì„± ë³´ì¥

### 3. 3ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤ vs ë‹¨ì¼ í™”ë©´
- **ì„ íƒ**: 3ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤ (ì‹ ì²­ ì„ íƒ â†’ ê°„ë³‘ì‚¬ ì„ íƒ â†’ í™•ì¸)
- **ì´ìœ **:
  - ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ (ë‹¨ê³„ë³„ ëª…í™•í•œ ì•ˆë‚´)
  - ì‹¤ìˆ˜ ë°©ì§€ (í™•ì¸ ë‹¨ê³„ì—ì„œ ì¬í™•ì¸)
  - ì§€ì—­ ê¸°ë°˜ ìë™ í•„í„°ë§ ê°€ëŠ¥

### 4. ìë™ ìƒíƒœ ì—…ë°ì´íŠ¸
- **ì„ íƒ**: ë§¤ì¹­ ìƒì„± ì‹œ CareRequest ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸
- **ì´ìœ **:
  - ë°ì´í„° ì¼ê´€ì„± ìœ ì§€
  - ê´€ë¦¬ì ì‹¤ìˆ˜ ë°©ì§€
  - ì›Œí¬í”Œë¡œìš° ìë™í™”

---

## âš ï¸ ì´ìŠˆ ë° í•´ê²°

### ë¬¸ì œ 1: Firestore Transaction íƒ€ì„ì•„ì›ƒ
- **ì¦ìƒ**: Transactionì´ ê°€ë” íƒ€ì„ì•„ì›ƒ ë°œìƒ
- **ì›ì¸**: ë„¤íŠ¸ì›Œí¬ ì§€ì—° ë˜ëŠ” ë™ì‹œ ìš”ì²­
- **í•´ê²°**: `try-catch`ë¡œ ì—ëŸ¬ ì²˜ë¦¬ + ì¬ì‹œë„ ë¡œì§ ì¶”ê°€

### ë¬¸ì œ 2: Base64 ì´ë¯¸ì§€ ë””ì½”ë”© ì‹¤íŒ¨
- **ì¦ìƒ**: ì¼ë¶€ ê°„ë³‘ì‚¬ í”„ë¡œí•„ ì‚¬ì§„ì´ í‘œì‹œë˜ì§€ ì•ŠìŒ
- **ì›ì¸**: Base64 ë¬¸ìì—´ì´ ë¹„ì–´ìˆê±°ë‚˜ ì˜ëª»ëœ í˜•ì‹
- **í•´ê²°**: `photoBase64.isNotEmpty()` ì²´í¬ + ê¸°ë³¸ ì•„ì´ì½˜ í‘œì‹œ

### ë¬¸ì œ 3: í•„í„°ë§ ì„±ëŠ¥ ì €í•˜
- **ì¦ìƒ**: ê°„ë³‘ì‚¬ ëª©ë¡ì´ ë§ì„ ë•Œ í•„í„°ë§ì´ ëŠë¦¼
- **ì›ì¸**: í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ëª¨ë“  ë°ì´í„°ë¥¼ í•„í„°ë§
- **í•´ê²°**: í˜„ì¬ëŠ” ê´œì°®ì§€ë§Œ, í–¥í›„ Firestore ì¿¼ë¦¬ë¡œ ì„œë²„ ì¸¡ í•„í„°ë§ ê³ ë ¤

---

## ğŸ“Š ì§„í–‰ ìƒí™©

### ì™„ë£Œëœ ê¸°ëŠ¥ (100%)
- âœ… **ê´€ë¦¬ì ì¸ì¦ ì‹œìŠ¤í…œ**: ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´
- âœ… **ê°„ë³‘ ì‹ ì²­ ëª©ë¡ í™”ë©´**: ì „ì²´ ì¡°íšŒ + ìƒíƒœë³„ í•„í„°ë§
- âœ… **ê°„ë³‘ì‚¬ ëª©ë¡ í™”ë©´**: ì „ì²´ ì¡°íšŒ + ë‹¤ì¤‘ í•„í„°ë§
- âœ… **SerialNumber ì‹œìŠ¤í…œ**: ì¼ë ¨ë²ˆí˜¸ ìƒì„± + í¬ë§·íŒ…
- âœ… **ë§¤ì¹­ ê´€ë¦¬ í™”ë©´**: 3ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤ + ìë™ ìƒíƒœ ì—…ë°ì´íŠ¸

### ë‹¤ìŒ ë‹¨ê³„
- [ ] **ì‚¬ìš©ì ê¸°ëŠ¥ ê°•í™”**: ë³´í˜¸ì/ê°„ë³‘ì‚¬ê°€ ìì‹ ì˜ ë§¤ì¹­ ë‚´ì—­ ì¡°íšŒ
- [ ] **í‘¸ì‹œ ì•Œë¦¼**: ë§¤ì¹­ ì™„ë£Œ ì‹œ ì•Œë¦¼
- [ ] **ë¦¬ë·° ë° í‰ì  ì‹œìŠ¤í…œ**: ê°„ë³‘ ì™„ë£Œ í›„ ë¦¬ë·° ì‘ì„±
- [ ] **ì›¹ í”Œë«í¼**: React + Viteë¡œ ì›¹ ê´€ë¦¬ì í˜ì´ì§€

---

## ğŸ‰ ì™„ë£Œ!

**ì§„í–‰ë¥ : 100%**

ëª¨ë“  ê´€ë¦¬ì ì‹œìŠ¤í…œ ê¸°ëŠ¥ì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!

---

## ğŸ“‚ íŒŒì¼ ë³€ê²½ ì‚¬í•­

### ì‹ ê·œ íŒŒì¼
- `data/model/Match.kt`
- `data/model/User.kt` (role í•„ë“œ ì¶”ê°€)
- `data/repository/MatchRepository.kt`
- `data/repository/MatchRepositoryImpl.kt`
- `presentation/screens/admin/AdminDashboardScreen.kt`
- `presentation/screens/admin/care_request/AdminCareRequestListViewModel.kt`
- `presentation/screens/admin/care_request/AdminCareRequestListScreen.kt`
- `presentation/screens/admin/caregiver/AdminCaregiverListViewModel.kt`
- `presentation/screens/admin/caregiver/AdminCaregiverListScreen.kt`
- `presentation/screens/admin/match/MatchManagementViewModel.kt`
- `presentation/screens/admin/match/MatchManagementScreen.kt`
- `util/SerialNumberFormatter.kt`
- `docs/data-models/Match.md`

### ìˆ˜ì • íŒŒì¼
- `data/model/CareRequest.kt` (serialNumber ì¶”ê°€)
- `data/model/Caregiver.kt` (serialNumber ì¶”ê°€)
- `data/repository/AuthRepository.kt` (isAdmin ì¶”ê°€)
- `data/repository/CareRequestRepository.kt` (generateSerialNumber, updateStatus ì¶”ê°€)
- `data/repository/CaregiverRepository.kt` (generateSerialNumber ì¶”ê°€)
- `presentation/navigation/Screen.kt` (ê´€ë¦¬ì í™”ë©´ ê²½ë¡œ ì¶”ê°€)
- `presentation/navigation/NavGraph.kt` (ê´€ë¦¬ì í™”ë©´ ì—°ë™)
- `di/AppModule.kt` (MatchRepository, ViewModel ë“±ë¡)
- `docs/data-models/CareRequest.md`
- `docs/data-models/Caregiver.md`
- `docs/data-models/User.md`

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2026-01-23 20:27
